name: Deploy Lambda With Steps

on:
  workflow_dispatch:
    inputs:
      lambda_name:
        description: 'Lambdaã®åå‰ï¼ˆlambda1, lambda2ãªã©ï¼‰'
        required: true
        default: lambda1

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ”½ ã‚³ãƒ¼ãƒ‰ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ
        uses: actions/checkout@v4

      - name: ğŸ”§ å‰å‡¦ç†ï¼ˆvenvä½œæˆãªã©ï¼‰
        id: pre
        uses: ./.github/actions/lambda-pre
        with:
          lambda_name: ${{ github.event.inputs.lambda_name }}

      - name: ğŸš€ ãƒ¡ã‚¤ãƒ³å‡¦ç†ï¼ˆzipä½œæˆãªã©ï¼‰
        id: main
        uses: ./.github/actions/lambda-main
        with:
          lambda_name: ${{ github.event.inputs.lambda_name }}
          pre_output: ${{ steps.pre.outputs.pre_message }}

      - name: ğŸ§¹ å¾Œå‡¦ç†ï¼ˆç¢ºèªãƒ»ãƒ­ã‚°å‡ºåŠ›ãªã©ï¼‰
        uses: ./.github/actions/lambda-post
        with:
          lambda_name: ${{ github.event.inputs.lambda_name }}
          main_result: ${{ steps.main.outputs.zip_path }}
